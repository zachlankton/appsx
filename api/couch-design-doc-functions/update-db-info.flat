"function (doc, req) {\n  if (!doc) {\n    if (\"id\" in req && req[\"id\"]) {\n      // create new document\n      const newDoc = JSON.parse(req[\"body\"]);\n      newDoc[\"_id\"] = req[\"id\"];\n      newDoc[\"created_by\"] = req[\"userCtx\"][\"name\"];\n      newDoc[\"created_at\"] = new Date().toISOString();\n\n      return [newDoc, \"New Doc Created\"];\n    }\n    // change nothing in database\n    return [null, \"No ID Provided\"];\n  }\n  const updateDoc = JSON.parse(req[\"body\"]);\n  updateDoc[\"_id\"] = doc[\"_id\"];\n  updateDoc[\"_rev\"] = doc[\"_rev\"];\n  updateDoc[\"created_at\"] = doc[\"created_at\"];\n  updateDoc[\"created_by\"] = doc[\"created_by\"];\n  updateDoc[\"edited_at\"] = new Date().toISOString();\n  updateDoc[\"edited_by\"] = req[\"userCtx\"][\"name\"];\n  return [updateDoc, \"Edited Doc \" + doc[\"_id\"]];\n}\n"
